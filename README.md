
# 📘 **README.md（完全版・最新版）**

# クイズ問題並べ替え GA ツール  
ジャンルのバラつきを最大化するために、進化アルゴリズム（GA）を用いてクイズ問題の並び順を最適化するツールです。  
CSV を入力すると、ジャンルが偏らない並び順を自動生成し、結果を CSV とログとして出力します。

---

# 📑 **目次**

1. [exe 化の手順](#exe-化の手順)  
2. [出力ファイル構成](#出力ファイル構成)  
3. [入力 CSV の仕様](#入力-csv-の仕様)  
4. [GA の評価指標](#ga-の評価指標)  
5. [実行中の表示](#実行中の表示)  
6. [実行方法（Python / exe）](#実行方法python--exe)  
7. [フォルダ構成例](#フォルダ構成例)  
8. [エラー仕様](#エラー仕様)  
9. [ライセンス](#ライセンス)

---

# 🚀 **exe 化の手順**

このツールは Python スクリプトですが、PyInstaller を使うことで **単体で動く exe** にできます。

## ■ 必要なもの
- Python 3.9〜3.12  
- pip  
- PyInstaller

## ■ PyInstaller のインストール

```
pip install pyinstaller
```

## ■ exe の作成

```
pyinstaller --onefile --console quiz_ga.py
```

成功すると以下が生成されます：

```
dist/
 └─ quiz_ga.exe   ← 完成品
```

---

# 📁 **出力ファイル構成**

実行すると、以下のようなフォルダ構成で出力されます。

```
output
│-- result.csv              ← 最新の最良の並び順
│-- score.txt               ← 最新のスコアまとめ
│
└── logs
     ├── gen_001
     │     ├── gen_001.txt          ← 世代 1 のスコア詳細
     │     └── result_gen_001.csv   ← 世代 1 の並び順
     │
     ├── gen_002
     │     ├── gen_002.txt
     │     └── result_gen_002.csv
     │
     └── …（世代数ぶん続く）
```

---

# 📥 **入力 CSV の仕様**

このツールは **列構造が自由な CSV** に対応しています。  
ただし、**列名に「ジャンル」という文字列が含まれる列が必須**です。

例：

- `ジャンル`
- `問題ジャンル`
- `ジャンル名`
- `ジャンル（分類）`

### ✔ 文字コード自動判定  
以下に対応：

- UTF-8  
- UTF-8(BOM)  
- Shift-JIS（自動で UTF-8 に変換）

### ✖ エラーになる場合

- 文字コードが上記以外  
- 「ジャンル」を含む列が存在しない  

---

# 🧠 **GA の評価指標**

| 指標 | 内容 |
|------|------|
| penalty | 同じジャンルが連続した回数（少ないほど良い） |
| transition_diversity | ジャンル遷移の種類数（多いほど良い） |
| distance_score | 同じジャンル同士の距離の合計（大きいほど良い） |
| total_score | 上記を組み合わせた総合スコア |

GA は **total_score を最大化**するように進化します。

---

# 📊 **実行中の表示**

毎世代、以下のように表示されます：

```
=== Generation 12 ===
Penalty: 1
Transition: 8
Distance: 42
Total Score: 11.2
[LOG] Gen 12: output/logs/gen_012 に保存しました
```

---

# 🖥 **実行方法（Python / exe）**

## ■ Python で実行する場合

### ● 基本

```
python quiz_ga.py input.csv
```

### ● 世代数を指定

```
python quiz_ga.py input.csv 200
```

---

## ■ exe で実行する場合

### ● 基本

```
quiz_ga.exe input.csv
```

### ● 世代数を指定

```
quiz_ga.exe input.csv 200
```

---

# 📡 **フォルダ構成例**

```
project/
 ├─ quiz_ga.py
 ├─ input.csv
 └─ output/
      ├─ result.csv
      ├─ score.txt
      └─ logs/
           ├─ gen_001/
           ├─ gen_002/
           └─ ...
```

exe 化した場合：

```
project/
 ├─ quiz_ga.exe
 ├─ input.csv
 └─ output/
      ├─ result.csv
      ├─ score.txt
      └─ logs/
           ├─ gen_001/
           ├─ gen_002/
           └─ ...
```


---

# ⚠ **8. エラー仕様（対策例つき）**

このツールでは、入力 CSV の文字コードや列名に問題がある場合、  
ユーザーが原因を特定しやすいように明確なエラーメッセージを表示します。

---

## ❌ **エラー: 文字コードがUTF-8ではありません**

### ● 発生条件  
- CSV が UTF-8 / UTF-8(BOM) / Shift-JIS のいずれでも読み込めない場合  
- Excel で保存した CSV が特殊なエンコードになっている場合  
- 文字化けを含むファイルを読み込んだ場合

### ● 表示されるメッセージ

```
エラー: 文字コードがUTF-8ではありません
```

### ● 対策例  
以下のいずれかを試してください：

1. **Excel で開き直して UTF-8 で保存し直す**  
   - Excel → 「名前を付けて保存」  
   - ファイルの種類 → **CSV UTF-8 (コンマ区切り)** を選択

2. **メモ帳で UTF-8 に変換する**  
   - CSV をメモ帳で開く  
   - 「名前を付けて保存」  
   - 文字コード → **UTF-8** を選択

3. **Shift-JIS の場合は BOM 付き UTF-8 に変換する**  
   - メモ帳で開いて UTF-8 で保存すると BOM が付くため確実に読み込める

4. **ファイルが壊れていないか確認する**  
   - 文字化けがある場合は元データを確認してください

---

## ❌ **エラー: ジャンルがありません**

### ● 発生条件  
- CSV の列名に「ジャンル」という文字列が含まれていない  
- 例：  
  - `カテゴリ`  
  - `type`  
  - `genre`（英語表記）  
  などは **認識されません**

### ● 表示されるメッセージ

```
エラー: ジャンルがありません
```

### ● 対策例  

1. **ジャンル列の名前を変更する**  
   CSV の列名に **「ジャンル」** を含めてください。

   例：  
   - `ジャンル`  
   - `問題ジャンル`  
   - `ジャンル名`  
   - `ジャンル（分類）`

2. **英語表記を日本語に変更する**  
   - `genre` → `ジャンル` に変更

3. **余計な空白や記号を削除する**  
   - ` ジャンル`（先頭に空白）  
   - `ジャンル `（末尾に空白）  
   などは認識されない場合があります

4. **列名の行が正しく読み込まれているか確認する**  
   - 1 行目がヘッダーになっているか確認してください


---

# 🎉 **ライセンス**

自由に改変・利用できます。

---
